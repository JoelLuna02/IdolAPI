{"version":3,"file":"song.resolver.js","names":["_mongoose","require","_database","_interopRequireDefault","_VTuber","_Song","song_resolver","exports","Query","songs","connectDB","Song","find","getSong","_","ID","isValidObjectId","Error","song","findById","Mutation","addSong","name","album","releasedate","compositor","mixing","lyrics","process","env","NODE_ENV","new_song","save","deleteSong","deleteOne","_id","deletedCount","assignSongToVtuber","SNGID","VTID","vtuber","VTuber","push"],"sources":["../../source/resolvers/song.resolver.js"],"sourcesContent":["import { isValidObjectId } from \"mongoose\";\nimport connectDB from \"../database\";\nimport VTuber from \"../models/VTuber\";\nimport Song from \"../models/Song\";\n\nexport const song_resolver = {\n\tQuery: {\n\t\tasync songs() {\n\t\t\tawait connectDB();\n\t\t\tconst songs = await Song.find();\n\t\t\treturn songs;\n\t\t},\n\t\tasync getSong(_, { ID }) {\n\t\t\tawait connectDB();\n\t\t\tif (!isValidObjectId(ID)) throw new Error(\"Invalid Song ID\");\n\t\t\tconst song = await Song.findById(ID);\n\t\t\tif (!song) throw new Error(\"Song not found!\");\n\t\t\treturn song;\n\t\t},\n\t},\n\tMutation: {\n\t\tasync addSong(_, { name, album, releasedate, compositor, mixing, lyrics }) {\n\t\t\tawait connectDB();\n\t\t\tif (process.env.NODE_ENV === \"production\") {\n\t\t\t\tthrow new Error(\"Mutation actions are only available in development mode\");\n\t\t\t}\n\t\t\tconst new_song = new Song({ name, album, releasedate, compositor, mixing, lyrics });\n\t\t\tconst song = await new_song.save();\n\t\t\treturn song;\n\t\t},\n\t\tasync deleteSong(_, { ID }) {\n\t\t\tawait connectDB();\n\t\t\tif (process.env.NODE_ENV === \"production\") {\n\t\t\t\tthrow new Error(\"Mutation actions are only available in development mode\");\n\t\t\t}\n\t\t\tif (!isValidObjectId(ID)) throw new Error(\"Invalid Song ID\");\n\t\t\tconst song = (await Song.deleteOne({ _id: ID })).deletedCount;\n\t\t\treturn song;\n\t\t},\n\t\tasync assignSongToVtuber(_, { SNGID, VTID }) {\n\t\t\tif (process.env.NODE_ENV === \"production\") {\n\t\t\t\tthrow new Error(\"Mutation actions are only available in development mode\");\n\t\t\t}\n\t\t\tawait connectDB();\n\t\t\tif (!isValidObjectId(VTID) || !isValidObjectId(SNGID)) {\n\t\t\t\tthrow new Error(\"Invalid VTuber or Song ID\");\n\t\t\t}\n\t\t\tconst vtuber = await VTuber.findById(VTID);\n\t\t\tconst song = await Song.findById(SNGID);\n\t\t\tif (!vtuber || !song) {\n\t\t\t\tthrow new Error(\"VTuber or Song not found\");\n\t\t\t}\n\t\t\tvtuber.songs.push(song._id);\n\t\t\tsong.vtuber = vtuber._id;\n\t\t\tawait vtuber.save();\n\t\t\tawait song.save();\n\t\t\treturn vtuber;\n\t\t},\n\t},\n};\n"],"mappings":"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","ignoreList":[]}